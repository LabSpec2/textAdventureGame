{% extends "story_template.html" %}
{% block title %}Fight!{% endblock %}

{% block content5 %}
	<div class="main-text">
		<p >Monster jumps at you! <br>
		Quick! Pick a weapon! <br>

		{% for x in hero.items %}
		<button id="pick_weapon" name="{{x}}" class="small_text_buttons">{{x}}</button> 
			{% endfor %}
		
	 </p> <!--formularz? -->

		<p id="fight"></p><br>
        <p id="comeback" style="visibility: hidden;" align="center"><a href="/{{room}}"><button class="big_buttons" style="width: 40%;">Come back to {{room}}.... </button></a></p>
		
	</div>


	<script type="text/javascript">
        var weapon_chosen = Boolean(false);
		document.addEventListener('DOMContentLoaded', () => {
			document.querySelectorAll('button').forEach(button => {
				button.onclick = () => {
                    if (weapon_chosen)
                        return;
                    button.style.color = "red";
                    weapon_chosen = Boolean(true);
					const request = new XMLHttpRequest();
					request.open('POST', `/${button.id}`);
					request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
					
					request.onload = () => {
						const response = request.responseText;
						document.getElementById('fight').innerHTML = response;
                        document.getElementById("comeback").style.visibility = "visible";
					}; 
					request.send(button.name);
					
				};
			});
		});
	</script>

{% endblock %}

